<!DOCTYPE html>
<html lang="en">
<head>
  <title>JS.ET</title>
  <meta charset="utf-8">
  <link href="css/jset.css" rel="stylesheet" type="text/css" />
  <script src="js/Wave.js"></script>
  <script src="js/RandomChord.js"></script>
  <script src="js/KeyboardShortcut.js"></script>
</head>

<body>
<div class="container">
  <h1>JS.ET</h1>

  <div class="btn w-25" onclick="playReference()">A4</div>
  <div class="btn w-75" id="randomBtn" onclick="playRandomChord()">Random Chord</div>
  <div class="btn w-50" onclick="repeatLastChord(true)">Melodic</div>
  <div class="btn w-100" onclick="reveal()">Reveal Last Chord</div>

  <div class="answer"></div>
</div>
<script>
  const answerDiv = document.getElementsByClassName('answer')[0];
  const randomBtn = document.getElementById('randomBtn');

  const referenceNote = new Note(69);

  const bottomNote = 60; //C4
  const chordSpan = 12; //one octave of questions
  let currentChord;
  let answered = true;

  function msg(msg){
    answerDiv.innerHTML = msg;
  }

  function playReference(){
    referenceNote.play();
  }

  function playRandomChord(){
    if(!answered) {
      repeatLastChord();
      return;
    }
    answered = false;

    referenceNote.stop();
    currentChord = new RandomChord(bottomNote, chordSpan);
    currentChord.play();
    msg('');
    randomBtn.innerHTML = 'Repeat';
  }

  function repeatLastChord(melodic){
    if(!currentChord){
      msg('Play a chord first');
      return;
    }
    currentChord.play(melodic);
  }

  function reveal(){
    if(!currentChord){
      msg('Play a chord first');
      return;
    }
    answered = true;
    answerDiv.innerHTML = currentChord.name;
    randomBtn.innerHTML = 'Random Chord';
  }

  new KeyboardShortcut('r', playRandomChord);
  new KeyboardShortcut('a', playReference);
  new KeyboardShortcut(' ', reveal);
</script>

</body>
</html>